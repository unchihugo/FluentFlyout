<Page x:Class="FluentFlyoutWPF.Pages.HomePage"
      xmlns="http://schemas.microsoft.com/winfx/2006/xaml/presentation"
      xmlns:x="http://schemas.microsoft.com/winfx/2006/xaml"
      xmlns:mc="http://schemas.openxmlformats.org/markup-compatibility/2006"
      xmlns:d="http://schemas.microsoft.com/expression/blend/2008"
      xmlns:ui="http://schemas.lepo.co/wpfui/2022/xaml"
      xmlns:viewModels="clr-namespace:FluentFlyoutWPF.ViewModels"
      xmlns:utils="clr-namespace:FluentFlyoutWPF.Classes.Utils"
      mc:Ignorable="d"
      d:DesignHeight="800" d:DesignWidth="600"
      Title="HomePage"
      d:DataContext="{d:DesignInstance viewModels:UserSettings}"
      Foreground="{DynamicResource TextFillColorPrimaryBrush}"
      d:Background="White">

    <Page.Resources>
        <utils:BoolToEnabledDisabledConverter x:Key="BoolToEnabledDisabledConverter" />
        <utils:BoolToVisibleCollapsedConverter x:Key="BoolToCollapsedVisibleConverter" TrueValue="Collapsed" FalseValue="Visible" />
        <utils:BoolToVisibleCollapsedConverter x:Key="BoolToVisibleCollapsedConverter" />
    </Page.Resources>

    <StackPanel MaxWidth="1000" Margin="16">
        <StackPanel Orientation="Horizontal" VerticalAlignment="Center" Margin="12,0,0,0">
            <Image Source="/Resources/FluentFlyout2.ico" Width="44" Height="44" />
            <TextBlock Text="{DynamicResource TitleText}" FontSize="24" FontWeight="Medium" Margin="12,0,0,0" VerticalAlignment="Center" />
            <TextBlock x:Name="VersionTextBlock" FontSize="14" FontWeight="Regular" VerticalAlignment="Bottom" Margin="10" Opacity="0.5" />
        </StackPanel>

        <TextBlock Text="{DynamicResource HomeTitle}" FontSize="24" FontWeight="SemiBold" FontFamily="Segoe UI Variable" Margin="0,36,0,12" />
        <StackPanel Orientation="Horizontal">
            <ui:Button x:Name="ViewUpdatesButton" Appearance="Transparent" Padding="0,0,16,0" BorderBrush="Transparent" Margin="0,0,16,16" Click="ViewUpdates_Click">
                <StackPanel Orientation="Horizontal">
                    <Border CornerRadius="8" ClipToBounds="True" Width="200" Height="98" Margin="0,0,16,0">
                        <Border.Background>
                            <ImageBrush ImageSource="/Resources/FluentFlyoutHero-NoTitle.webp" Stretch="UniformToFill" />
                        </Border.Background>
                    </Border>
                    <StackPanel Orientation="Vertical" VerticalAlignment="Center">
                        <ui:TextBlock Text="{DynamicResource UpdateToastButton}" FontWeight="SemiBold" />
                        <ui:TextBlock Text="{DynamicResource HomeUpdateDescription}" Opacity="0.5" FontSize="12" />
                    </StackPanel>
                </StackPanel>
            </ui:Button>

            <!--Update status indicator-->
            <ui:Button Appearance="Transparent" Padding="8" BorderBrush="Transparent" Margin="0,0,16,16" Click="CheckForUpdates_Click">
                <StackPanel Orientation="Horizontal">
                    <ui:SymbolIcon x:Name="UpdateStatusIcon" FontSize="24" Margin="0,0,12,0">
                        <ui:SymbolIcon.Style>
                            <Style TargetType="ui:SymbolIcon">
                                <Setter Property="Foreground" Value="{DynamicResource TextFillColorPrimaryBrush}" />
                                <Style.Triggers>
                                    <DataTrigger Binding="{Binding IsUpdateAvailable, Source={x:Static viewModels:UpdateState.Current}}" Value="True">
                                        <Setter Property="Symbol" Value="ArrowDownload24" />
                                        <Setter Property="Foreground" Value="{DynamicResource AccentTextFillColorPrimaryBrush}" />
                                        <Setter Property="Filled" Value="False" />
                                    </DataTrigger>
                                    <DataTrigger Binding="{Binding IsUpdateAvailable, Source={x:Static viewModels:UpdateState.Current}}" Value="False">
                                        <Setter Property="Symbol" Value="CheckmarkCircle24" />
                                        <Setter Property="Foreground" Value="{DynamicResource SystemFillColorSuccessBrush}" />
                                        <Setter Property="Filled" Value="True" />
                                    </DataTrigger>
                                </Style.Triggers>
                            </Style>
                        </ui:SymbolIcon.Style>
                    </ui:SymbolIcon>
                    <StackPanel Orientation="Vertical" VerticalAlignment="Center">
                        <ui:TextBlock x:Name="UpdateStatusText" FontWeight="SemiBold">
                            <ui:TextBlock.Style>
                                <Style TargetType="ui:TextBlock">
                                    <Setter Property="Text" Value="{DynamicResource UpToDate}" />
                                    <Style.Triggers>
                                        <DataTrigger Binding="{Binding IsUpdateAvailable, Source={x:Static viewModels:UpdateState.Current}}" Value="True">
                                            <Setter Property="Text" Value="{DynamicResource UpdateAvailable}" />
                                            <Setter Property="Foreground" Value="{DynamicResource AccentTextFillColorPrimaryBrush}" />
                                        </DataTrigger>
                                    </Style.Triggers>
                                </Style>
                            </ui:TextBlock.Style>
                        </ui:TextBlock>
                        <ui:TextBlock x:Name="LastCheckedText" Opacity="0.5" FontSize="12" />
                    </StackPanel>
                </StackPanel>
            </ui:Button>

            <!--Supporter status indicator-->
            <ui:Button Appearance="Transparent" Padding="8" BorderBrush="Transparent" Margin="0,0,0,16" IsHitTestVisible="False">
                <ui:Button.Style>
                    <Style TargetType="ui:Button" BasedOn="{StaticResource {x:Type ui:Button}}">
                        <Setter Property="Visibility" Value="Collapsed" />
                        <Style.Triggers>
                            <MultiDataTrigger>
                                <MultiDataTrigger.Conditions>
                                    <Condition Binding="{Binding IsStoreVersion}" Value="True"/>
                                    <Condition Binding="{Binding IsPremiumUnlocked}" Value="True"/>
                                </MultiDataTrigger.Conditions>
                                <Setter Property="Visibility" Value="Visible"/>
                            </MultiDataTrigger>
                        </Style.Triggers>
                    </Style>
                </ui:Button.Style>
                <StackPanel Orientation="Horizontal">
                    <ui:SymbolIcon Symbol="Heart24" FontSize="24" Margin="0,0,10,0" Foreground="{DynamicResource AccentTextFillColorPrimaryBrush}" />
                    <StackPanel Orientation="Vertical" VerticalAlignment="Center">
                        <ui:TextBlock Text="Supporter" FontWeight="SemiBold" />
                        <ui:TextBlock Text="Thank you!" Opacity="0.5" />
                    </StackPanel>
                </StackPanel>
            </ui:Button>
        </StackPanel>

        <TextBlock Grid.Row="6" Text="{DynamicResource HomeDashboardTitle}" FontSize="14" FontWeight="SemiBold" Margin="0,0,0,6" />
        <Grid Margin="-4">
            <Grid.RowDefinitions>
                <RowDefinition Height="Auto" />
                <RowDefinition Height="Auto" />
                <RowDefinition Height="Auto" />
            </Grid.RowDefinitions>
            <Grid.ColumnDefinitions>
                <ColumnDefinition Width="*" />
                <ColumnDefinition Width="*" />
            </Grid.ColumnDefinitions>
            <ui:CardAction Grid.Row="0" Grid.Column="0" Margin="4" Padding="12,20" IsChevronVisible="True" Click="MediaFlyout_Click">
                <ui:CardAction.Icon>
                    <ui:SymbolIcon Symbol="VideoPlayPause24" FontSize="30" Filled="False" />
                </ui:CardAction.Icon>
                <StackPanel>
                    <ui:TextBlock FontWeight="Medium" Text="{DynamicResource MediaFlyoutTitle}" />
                    <ui:TextBlock Appearance="Secondary" Text="{Binding MediaFlyoutEnabled, Converter={StaticResource BoolToEnabledDisabledConverter}}">
                        <ui:TextBlock.Style>
                            <Style TargetType="ui:TextBlock">
                                <Setter Property="Opacity" Value="1" />
                                <Style.Triggers>
                                    <DataTrigger Binding="{Binding MediaFlyoutEnabled}" Value="False">
                                        <Setter Property="Opacity" Value="0.5" />
                                    </DataTrigger>
                                </Style.Triggers>
                            </Style>
                        </ui:TextBlock.Style>
                    </ui:TextBlock>
                </StackPanel>
            </ui:CardAction>

            <ui:CardAction Grid.Row="0" Grid.Column="1" Margin="4" Padding="12,20" IsChevronVisible="True" Click="TaskbarWidget_Click">
                <ui:CardAction.Icon>
                    <ui:SymbolIcon Symbol="TextboxAlignBottom24" FontSize="30" Filled="False" />
                </ui:CardAction.Icon>
                <StackPanel>
                    <ui:TextBlock FontWeight="Medium" Text="{DynamicResource TaskbarWidgetCustomizationTitle}" />
                    <ui:TextBlock Appearance="Secondary" Text="{Binding TaskbarWidgetEnabled, Converter={StaticResource BoolToEnabledDisabledConverter}}">
                        <ui:TextBlock.Style>
                            <Style TargetType="ui:TextBlock">
                                <Setter Property="Opacity" Value="1" />
                                <Style.Triggers>
                                    <DataTrigger Binding="{Binding TaskbarWidgetEnabled}" Value="False">
                                        <Setter Property="Opacity" Value="0.5" />
                                    </DataTrigger>
                                </Style.Triggers>
                            </Style>
                        </ui:TextBlock.Style>
                    </ui:TextBlock>
                </StackPanel>
            </ui:CardAction>

            <ui:CardAction Grid.Row="1" Grid.Column="0" Margin="4" Padding="12,20" IsChevronVisible="True" Click="NextUp_Click">
                <ui:CardAction.Icon>
                    <ui:SymbolIcon Symbol="MusicNote2Play20" FontSize="30" Filled="False" />
                </ui:CardAction.Icon>
                <StackPanel>
                    <ui:TextBlock FontWeight="Medium" Text="{DynamicResource NextUpCustomizationTitle}" />
                    <ui:TextBlock Appearance="Secondary" Text="{Binding NextUpEnabled, Converter={StaticResource BoolToEnabledDisabledConverter}}">
                        <ui:TextBlock.Style>
                            <Style TargetType="ui:TextBlock">
                                <Setter Property="Opacity" Value="1" />
                                <Style.Triggers>
                                    <DataTrigger Binding="{Binding NextUpEnabled}" Value="False">
                                        <Setter Property="Opacity" Value="0.5" />
                                    </DataTrigger>
                                </Style.Triggers>
                            </Style>
                        </ui:TextBlock.Style>
                    </ui:TextBlock>
                </StackPanel>
            </ui:CardAction>

            <ui:CardAction Grid.Row="1" Grid.Column="1" Margin="4" Padding="12,20" IsChevronVisible="True" Click="LockKeys_Click">
                <ui:CardAction.Icon>
                    <ui:SymbolIcon Symbol="LockMultiple24" FontSize="30" Filled="False" />
                </ui:CardAction.Icon>
                <StackPanel>
                    <ui:TextBlock FontWeight="Medium" Text="{DynamicResource LockKeysCustomizationTitle}" />
                    <ui:TextBlock Appearance="Secondary" Text="{Binding LockKeysEnabled, Converter={StaticResource BoolToEnabledDisabledConverter}}">
                        <ui:TextBlock.Style>
                            <Style TargetType="ui:TextBlock">
                                <Setter Property="Opacity" Value="1" />
                                <Style.Triggers>
                                    <DataTrigger Binding="{Binding LockKeysEnabled}" Value="False">
                                        <Setter Property="Opacity" Value="0.5" />
                                    </DataTrigger>
                                </Style.Triggers>
                            </Style>
                        </ui:TextBlock.Style>
                    </ui:TextBlock>
                </StackPanel>
            </ui:CardAction>

            <ui:CardAction Grid.Row="2" Grid.Column="0" Margin="4" Padding="12,20" IsChevronVisible="True" Click="System_Click">
                <ui:CardAction.Icon>
                    <ui:SymbolIcon Symbol="Settings24" FontSize="30" Filled="False" />
                </ui:CardAction.Icon>
                <StackPanel>
                    <ui:TextBlock FontWeight="Medium" Text="{DynamicResource SystemSettingsTitle}" />
                    <ui:TextBlock Appearance="Secondary" Text="{DynamicResource SystemConfigure}" />
                </StackPanel>
            </ui:CardAction>
        </Grid>

        <StackPanel Orientation="Horizontal" Margin="0,16,0,0">
            <ui:Button Appearance="Transparent" Padding="16,4,16,0" Height="56" BorderBrush="Transparent" Margin="0,0,8,0" Click="ViewMicrosoftStore_Click">
                <StackPanel Orientation="Horizontal">
                    <StackPanel Orientation="Vertical" VerticalAlignment="Center">
                        <ui:SymbolIcon Symbol="StoreMicrosoft20" FontSize="18" Filled="False" />
                        <ui:TextBlock Text="Microsoft Store" FontWeight="Normal" />
                    </StackPanel>
                </StackPanel>
            </ui:Button>

            <ui:Button Appearance="Transparent" Padding="16,4,16,0" Height="56" BorderBrush="Transparent" Margin="0,0,8,0" Click="ViewLogs_Click">
                <StackPanel Orientation="Horizontal">
                    <StackPanel Orientation="Vertical" VerticalAlignment="Center">
                        <ui:SymbolIcon Symbol="FolderOpen20" FontSize="18" Filled="False" />
                        <ui:TextBlock Text="{DynamicResource TrayIcon_ViewLogsOption}" FontWeight="Normal" />
                    </StackPanel>
                </StackPanel>
            </ui:Button>

            <ui:Button Appearance="Transparent" Padding="16,4,16,0" Height="56" BorderBrush="Transparent" Margin="0,0,8,0" Click="ReportBug_Click">
                <StackPanel Orientation="Horizontal">
                    <StackPanel Orientation="Vertical" VerticalAlignment="Center">
                        <ui:SymbolIcon Symbol="Bug20" FontSize="18" Filled="False" />
                        <ui:TextBlock Text="{DynamicResource TrayIcon_ReportBugOption}" FontWeight="Normal" />
                    </StackPanel>
                </StackPanel>
            </ui:Button>
        </StackPanel>

        <TextBlock Text="{DynamicResource AboutPremiumTitle}" FontSize="14" FontWeight="SemiBold" FontFamily="Segoe UI Variable" Margin="0,36,0,0" />
        <Grid Margin="0,12,0,0">
            <Grid.RowDefinitions>
                <RowDefinition Height="Auto" />
                <RowDefinition Height="Auto" />
                <RowDefinition Height="Auto" />
            </Grid.RowDefinitions>

            <!-- Premium Status InfoBar (only shown for Store versions) -->
            <ui:InfoBar Grid.Row="0" Title="{DynamicResource PremiumUnlockedMessage}" Severity="Success" IsClosable="True" Margin="0,0,0,12">
                <ui:InfoBar.Style>
                    <Style TargetType="ui:InfoBar" BasedOn="{StaticResource {x:Type ui:InfoBar}}">
                        <Setter Property="IsOpen" Value="False" />
                        <Style.Triggers>
                            <MultiDataTrigger>
                                <MultiDataTrigger.Conditions>
                                    <Condition Binding="{Binding IsStoreVersion}" Value="True"/>
                                    <Condition Binding="{Binding IsPremiumUnlocked}" Value="True"/>
                                </MultiDataTrigger.Conditions>
                                <Setter Property="IsOpen" Value="True"/>
                            </MultiDataTrigger>
                        </Style.Triggers>
                    </Style>
                </ui:InfoBar.Style>
            </ui:InfoBar>

            <!-- Premium Locked InfoBar (only shown for Store versions without premium) -->
            <ui:InfoBar Grid.Row="0" IsOpen="True" Severity="Warning" IsClosable="False" Margin="0,4,0,12">
                <ui:InfoBar.Style>
                    <Style TargetType="ui:InfoBar">
                        <Setter Property="Visibility" Value="Collapsed"/>
                        <Style.Triggers>
                            <MultiDataTrigger>
                                <MultiDataTrigger.Conditions>
                                    <Condition Binding="{Binding IsStoreVersion}" Value="True"/>
                                    <Condition Binding="{Binding IsPremiumUnlocked}" Value="False"/>
                                </MultiDataTrigger.Conditions>
                                <Setter Property="Visibility" Value="Visible"/>
                            </MultiDataTrigger>
                        </Style.Triggers>
                    </Style>
                </ui:InfoBar.Style>
                <StackPanel Orientation="Horizontal">
                    <ui:Button Name="UnlockPremiumButton" Content="{DynamicResource UnlockPremiumButton}" 
                        Click="UnlockPremiumButton_Click" 
                        Appearance="Primary"
                        Margin="4,0,0,8" FontSize="12"/>
                </StackPanel>
            </ui:InfoBar>

            <!-- GitHub Version InfoBar -->
            <ui:InfoBar Grid.Row="0" Title="{DynamicResource PremiumGitHubMessage}" IsOpen="True" Severity="Informational" IsClosable="False" Margin="0,0,0,12" Visibility="{Binding IsStoreVersion, Converter={StaticResource BoolToCollapsedVisibleConverter}}" />

            <ui:TextBlock Grid.Row="1" FontSize="14" Margin="4,0,0,0" FontWeight="Regular" HorizontalAlignment="Left" Opacity="0.75" TextWrapping="WrapWithOverflow" Text="{DynamicResource PremiumFeatureDescription}" Visibility="{Binding IsStoreVersion, Converter={StaticResource BoolToVisibleCollapsedConverter}}" />
        </Grid>

        <DockPanel LastChildFill="False" Margin="0,24,0,12">
            <StackPanel Orientation="Horizontal" DockPanel.Dock="Bottom" HorizontalAlignment="Left">
                <ui:SymbolIcon Symbol="Star24" Filled="True" Width="24" Height="24" FontSize="16" VerticalAlignment="Center" Foreground="Gold" />
                <StackPanel Orientation="Vertical" VerticalAlignment="Center">
                    <TextBlock Text="{DynamicResource EnjoyingAppText}" HorizontalAlignment="Center" FontSize="12" Opacity="0.5" VerticalAlignment="Center" Margin="4,0,0,0" />
                </StackPanel>
                <ui:Anchor Content="{DynamicResource GitHubRepoLink}" Icon="{ui:SymbolIcon Open24}" NavigateUri="https://github.com/unchihugo/FluentFlyout" Margin="12,0,0,0" />
            </StackPanel>
        </DockPanel>
    </StackPanel>
</Page>